

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1. Introduction &mdash; CaLES  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2. Tutorial" href="2.Tutorial.html" />
    <link rel="prev" title="CaLES Documentation" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            CaLES
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">1. Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">1.1. Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#implementation">1.2. Implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#getting-started">1.3. Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="#contributing">1.4. Contributing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="2.Tutorial.html">2. Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.Examples.html">3.Examples</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CaLES</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">1. Introduction</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/1.Introduction.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="introduction">
<h1>1. Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h1>
<p>This section introduces the CaNS.</p>
<div class="toctree-wrapper compound">
</div>
<section id="overview">
<h2>1.1. Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>CaLES (Canonical Large-Eddy Simulation) is a GPU-accelerated finite-difference solver designed for large-eddy simulations (LES) of incompressible wall-bounded flows in massively parallel environments. Built upon the existing direct numerical simulation (DNS) solver CaNS, CaLES relies on low-storage, third-order Runge-Kutta schemes for temporal discretization, with the option to treat viscous terms via an implicit Crank-Nicolson scheme in one or three directions. A fast direct solver, based on eigenfunction expansions, is used to solve the discretized Poisson/Helmholtz equations. For turbulence modeling, the classical Smagorinsky model with van Driest near-wall damping and the dynamic Smagorinsky model are implemented, along with a logarithmic law wall model. GPU acceleration is achieved through OpenACC directives. Some examples of flows that CaLES can solve include:</p>
<p>periodic or developing channel
periodic or developing square duct
tri-periodic domain
lid-driven cavity
In the x and y directions, the grid is uniform and the solver supports the following homogeneous boundary conditions for the Poisson equation:</p>
<p>Neumann-Neumann
Dirichlet-Dirichlet
Neumann-Dirichlet
Periodic
In the z direction, the solver offers more flexibility by using Gauss elimination, allowing for a non-uniform grid.</p>
<p>CaLES allows for choosing an implicit temporal discretization of the momentum diffusion terms, either fully implicit or only along the z direction. This results in solving a 3D/1D Helmholtz equation per velocity component. In the fully implicit case, FFT-based solvers are also used, and the same options described above for pressure boundary conditions apply to the velocity. This implies that if the wall model is used, it can only be applied in the z direction, as homogeneous boundary conditions are required in the other two directions where FFTs are applied. However, this limitation may be irrelevant, as explicit time integration is commonly used for wall-modeled LES due to the large thickness of the first off-wall layer of cells. Additionally, this restriction does not apply when the viscous terms are handled implicitly only in the z-direction.</p>
<p>Please refer to the theory manual docs/CaLES_theory.pdf for more information on the methodology of CaLES. The theory manual is also available on Overleaf at the following link: <a class="reference external" href="https://www.overleaf.com/read/ggfmdsymppxm#9b973d">https://www.overleaf.com/read/ggfmdsymppxm#9b973d</a>.</p>
</section>
<section id="implementation">
<h2>1.2. Implementation<a class="headerlink" href="#implementation" title="Link to this heading"></a></h2>
<p>Some of the key implementation features of CaLES are:</p>
<p>MPI parallelization
FFTW guru interface/cuFFT used for computing multi-dimensional vectors of 1D transforms
The right type of transformation (Fourier, cosine, sine, etc) is automatically determined form the input file
cuDecomp pencil decomposition library for hardware-adaptive distributed memory calculations on many GPUs
2DECOMP&amp;FFT library used for performing global data transpositions on CPUs and some of the data I/O
GPU acceleration using OpenACC directives
A different canonical flow can be simulated by simply changing the input files
Please refer to the following references for further details:</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Xiao, Maochao, Alessandro Ceci, Pedro Costa, Johan Larsson, and Sergio Pirozzoli. “CaLES: A GPU-accelerated solver for large-eddy simulation of wall-bounded flows.” arXiv preprint arXiv:2411.09364 (2024).</p>
<p>Costa, Pedro, Everett Phillips, Luca Brandt, and Massimiliano Fatica. “GPU acceleration of CaNS for massively-parallel direct numerical simulations of canonical fluid flows.” Computers &amp; Mathematics with Applications 81 (2021): 502-511.</p>
<p>Costa, Pedro. “A FFT-based finite-difference solver for massively-parallel direct numerical simulations of turbulent flows.” Computers &amp; Mathematics with Applications 76 (2018): 1853-1862.</p>
</div>
</section>
<section id="getting-started">
<h2>1.3. Getting Started<a class="headerlink" href="#getting-started" title="Link to this heading"></a></h2>
<p><strong>Installation</strong></p>
<p>Since CaLES loads the external pencil decomposition libraries as Git Submodules, the repository should be cloned as follows:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>git clone --recursive https://github.com/soaringxmc/CaLES.git
</pre></div>
</div>
<p>so the libraries are downloaded too. Alternatively, in case the repository has already been cloned without the Submodules (i.e., folders cuDecomp and 2decomp-fft under dependencies/ are empty), the following command can be used to update them:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>git submodule update --init --recursive
</pre></div>
</div>
<p>The prerequisites for compiling CaLES are the following:</p>
<p>MPI
FFTW3/cuFFT library for CPU/GPU runs
The nvfortran compiler (for GPU runs)
NCCL and NVSHMEM (optional, may be exploited by the cuDecomp library)
For most systems, CaLES can be compiled from the root directory with the following commands make libs &amp;&amp; make, which will compile the 2DECOMP&amp;FFT/cuDecomp libraries and CaLES.</p>
<p>The Makefile in root directory is used to compile the code, and is expected to work out-of-the-box for most systems. The build.conf file in the root directory can be used to choose the Fortran compiler (MPI wrapper), and a few pre-defined profiles depending on the nature of the run (e.g., production vs debugging), and pre-processing options, see INFO_COMPILING.md for more details. Concerning the pre-processing options, the following are available:</p>
<p>DEBUG : performs some basic checks for debugging purposes
TIMING : wall-clock time per time step is computed
IMPDIFF : diffusion terms are integrated implicitly in time (thereby improving the stability of the numerical algorithm for viscous-dominated flows)
IMPDIFF_1D : same as above, but with implicit diffusion only along z; for optimal parallel performance this option should be combined with PENCIL_AXIS=3
PENCIL_AXIS : sets the default pencil direction, one of [1,2,3] for [X,Y,Z]-aligned pencils; X-aligned is the default and should be optimal for all cases except for Z implicit diffusion, where using Z-pencils is recommended
SINGLE_PRECISION : calculation will be carried out in single precision (the default precision is double)
GPU : enable GPU-accelerated runs
USE_NVTX : enable NVTX tags for profiling
The executable cales will be created in the build/ directory.</p>
<p><strong>Running Simulations</strong></p>
<p>The input file input.nml sets the physical and computational parameters. In the examples/ folder are examples of input files for several canonical flows. See INFO_INPUT.md for a detailed description of the input file.
Files out1d.h90, out2d.h90 and out3d.h90 in src/ set which data are written in 1-, 2- and 3-dimensional output files, respectively. The code should be recompiled after editing out?d.h90 files.
Run the executable with mpirun with a number of tasks. For example, to run the code with 2 tasks:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>mpirun -n 2 cales
</pre></div>
</div>
<p>See INFO_VISU.md for how to visualize the output files.</p>
</section>
<section id="contributing">
<h2>1.4. Contributing<a class="headerlink" href="#contributing" title="Link to this heading"></a></h2>
<p>We appreciate any contributions and feedback that can improve CaLES. If you wish to contribute to the tool, please get in touch with the maintainers or open an Issue in the repository / a thread in Discussions. Pull Requests are welcome, but please propose/discuss the changes in an linked Issue first.
To contribute to CaLES, please follow the steps listed below:
1.Fork this repository to your GitHub account
2.Create a new branch in your forked repository
3.Make changes in your new branch
4.Submit your changes by creating a Pull Request to the develop branch of the original PyFR repository
Modifications to the develop branch are eventually merged into the master branch for a new release.</p>
<p>You can download the CaLES theory PDF file from here:</p>
<a href="CaLES_theory.pdf">Download PDF</a></section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="CaLES Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="2.Tutorial.html" class="btn btn-neutral float-right" title="2. Tutorial" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, CaLES contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>